# VoidCoin.net
와라페이 포인트 시스템

## 보이드코인 설명 - 와라페이 포인트 시스템
총 세 가지 형태의 리웨드 포인트 시스템을 손쉽게 구축하기 위하여 보이드 코인을 사용합니다.
1. 방문형 리워드 시스템
  ; 여러분의 매장이나, 여러분의 서비스에서 일정 시간마다 바뀌는 QR 코드를 표시해두고, 정해진 시간에 한 번 방문하여 해당 QR 코드를 스캔하는 고객에게 리워드를 주는 형태입니다.

2. 사용 시작과 종료를 직접 고객이 결정 가능한 시간당 리워드 시스템
  ; 여러분의 매장이나, 여러분의 서비스를 시작할 때, QR을 표시해서 스캔하여 시작되고, 매장에서 나갈때나 서비스를 종료할 때 QR을 표시하여 스캔하면, 그 시간동안의 사용으로 판단하여 리워드를 주는 형태입니다.

3. 사용 시작후 특정 조건에 종료될 때, 시간당 리워드 시스템
  ; 여러분의 서비스를 시작할 때, QR을 표시해서 스캔하여 시작되고, 서비스내에서 특정 조건에 의해서 종료될 때, 자동으로 종료를 통지하여 해당 시간동안의 사용으로 계산하여 리워드를 주는 형태로, 2번보다 자동화된 시스템에 쓰입니다.

## API 설명서

### 1. 리워드 QR 생성 요청

* 요청 메세지 URL

HTTP URL|http://wara-kr.quickget.co/pay/request_point.html
----|----
HTTP Method|POST

* 요청 메세지 전달 인자설명

인자명|필요여부|기본값|설명
----|----|----|----
appid|필요|없음|포인트 제공자 appid(와라페이 앱의 내정보>APPID에서 확인 가능)
callback|필요|json|[json]으로 생성된 QR관련 내용 리턴됨
failure_time|옵션|없음|해당 QR코드의 유효시간(분). 해당 시간이 지난후에 해당 QR을 스캔하면 실패함
interval_time|필요|1|리워드가 제공되는 단위(분). 예를들어 10분으로 설정하면, 리워드를 줘야 할 시간/10분으로 계산하여 곱하기 point 만큼의 리워드를 제공함
point|필요|1|한번에 제공할 리워드의 양. 0 이상의 수치여야 함
point_type|필요|1|리워드 제공방식. 1-방문형 리워드 제공 방식, 2-사용시작과 종료QR스캔으로 리워드 제공 방식, 3-사용시작 QR스캔후 포인트 서버에서 종료를 통보하여 리워드 제공 방식 
time|필요|없음|요청시간(php의 time()함수값)
token|옵션|없음|point_type이 3일 경우에 사용되며, 여기서 전달된 token을 이용하여, 포인트 서버에서 서비스 종료시점 등에 '2. 포인트 서버 종료'메세지를 보내는데 사용됨. 반드시 매번 QR 생성 요청시에 이 token 값은 달라져야 함. 보통 time 값 등을 사용하는게 좋음
signature|필요|없음|중요 : 포인트 제공자의 포인트 생성시 입력한 비밀번호로, 위의 전달할 모든 변수 내용 문자열을 MD5 연산한 값을 전달하여, 변조된 내용이 아닌지를 확인시키는 용도

* POST 요청에 대한 리턴값(응답 메세지) 설명

인자명|설명
----|----
code|0이면 성공, 1이면 실패
quickid|해당 QR의 독립된 생성 번호
message|성공시, QR코드용 주소. 실패시 실패 관련 메세지 
qrcode|QR코드의 이미지파일. 이를 포인트 제공자는 얻어서 자신의 서비스에 표시
token|

<pre>
성공시 예: 
	{
		"code": 0,
		"quickid": 346,
		"message": "https:\/\/epay.miguyouxi.com\/jump-init.do?cmd=quick&country=kr&id=MzQ2",
		"qrcode": "http:\/\/wara-kr.quickget.co\/uploadfile\/qrcode\/3139ed4b18377b36bcf1857bb8255489_logo.png",
		"token": "1645r0c"
	}
	
실패시 예: 
	{"code":1,"message":"appid_error"}
</pre>

### 2. 서비스 종료 및 리워드 획득 통지 ( point_type이 3인 경우에만 사용 가능 )
주의 : point_type이 1이나 2인 경우에는, QR을 생성하는 것 만으로 리워드 처리가 가능하지만, 3인 경우에는 포인트 제공자측에서 주동적으로 서비스 종료됨을 알려 리워드를 적립을 완료해줘야 하기에 사용하는 API

* 요청 메세지 URL

HTTP URL|http://wara-kr.quickget.co/pay/pointEnd.html
----|----
HTTP Method|POST

* 요청 메세지 전달 인자설명

인자명|필요여부|기본값|설명
----|----|----|----
appid|필요|없음|포인트 제공자 appid(와라페이 앱의 내정보>APPID에서 확인 가능)
token|필요|없음|시작 QR을 생성시 전달했던 token값을 다시 전달하여, 해당 서비스가 종료됨을 알림

* POST 요청에 대한 리턴값(응답 메세지) 은 없음. 포인트 제공자측에서 와라페이에 일방적으로 통보하는 것이며, 이 기준으로 시작 QR을 읽었던 고객에게는 리워드가 제공되기 때문에 통보되는 내용이 없음
